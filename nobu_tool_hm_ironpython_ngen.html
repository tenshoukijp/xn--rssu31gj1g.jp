%(hilight)s
<h2><i class="fa fa-book fa-fw"></i>NGenのススメ ～読み込み実行の高速化～</h2>

<ul class="checklist">
    <li>
    <h3>概要</h3>
    <p>IronPython.dllはモジュールとして4M近い大きさの単体ファイルであるため、<br>
    最初にIronPython.dllを読み込みをし、プログラムが自動的に、中間言語をCPUが実行出来るネイティブイメージに変換するため、<br>
    スクリプトを実行しはじめるまでに少し時間がかかります。<br>
    </p>
    <p>実際に、hmPy.dllを利用したマクロ(IronPythonスクリプト)を実行すると、<br>
    少し待ち時間を体感出来るハズです。<br>
    </p>
    <p>同じスクリプトを２回目以降実行する分には、この時間は大幅に短縮されます。<br>
    <h3>NGenを利用し、待ち時間を大幅短縮</h3>
    <p>NGen(ネイティブ イメージ ジェネレーター)を利用することで、hmPy.dllが利用するIronPython.dllの <span class="positive">この最初の待ち時間を大幅にカット</span>することが出来ます。</p>
    <ul class="pointlist">
        <li>
        <h4>「管理者権限」でプロンプトを実行</h4>
        <p>管理者権限でプロンプトを実行します。管理者権限であることが必須です。</p>
        <li>
        <h4>.NET Frameworkのフォルダへと移動</h4>
        <div class="code"><pre class="brush:ps">
cd C:\Windows\Microsoft.NET\Framework\v4.0.30319
</pre></div>

        <span class="negative">もしも、<b>x86版のhmPy.dllではなく、x64版のhmPy.dllを利用している人</b>は、</span>
        <div class="code"><pre class="brush:ps">
cd C:\Windows\Microsoft.NET\Framework64\v4.0.30319
</pre></div>
        <span class="negative">といったように、64版のFrameworkディレクトリへと移動してください</span>

        <li>
        <h4>IronPython.dllのネイティブイメージを作成</h4>
        <p>以下のように「ngen install」のコマンドを利用して、ネイティブイメージを作成してください。 「C:\usr\hidemaru\IronPython.dll」の部分は、実際のあなたの秀丸のディレクトリやIronPythond.dllの位置に合わせてください。
        <div class="code"><pre class="brush:ps">
ngen install "C:\usr\hidemaru\IronPython.dll"
</pre></div>
    </ul>
    <h3>IronPython.dllが更新されたら、再度NGenする必要がある。</h3>
    <p>IronPython.dllが更新されたら、再びNGenをしてください。</p>

    <p><img src="./other_soft/hm_ironpython/cnt_hm_ironpython_ngen_01.png"></p>
</ul>
