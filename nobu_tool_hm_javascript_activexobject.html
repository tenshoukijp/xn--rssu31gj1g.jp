%(hilight)s
<h2><i class="fa fa-book fa-fw"></i>「hmJS」でActiveXObject</h2>

<ul class="checklist">
    <li>
    <h3>概要</h3>
    <p>ここでは、.NET Frameworkに最初から搭載されているものの、<br>
    手動で参照を追加する必要があるdll(例えばSystem.Windows.Formなど)を読み込む方法を記載しています。<br>
    </p>
    <p>そういった場合には、自身でそのような定義をすればよいことでしょう。</p>
    <li>
    <h3>WScript.Echo(...) などの古い記述</h3>
    <p>WScript.Echo(...)などは、JScript本体というよりも、WSHの記述ですので、hmJSでは直接に対応してはいません。<br>
    しかし、「WScript.Echo」だけは、古いソースの記述に散見されるので、利用したい、といったこともあるかもしれません。</p>
    <p>そういった場合には、自身でそのような定義をすればよいことでしょう。</p>
    <div class="code"><pre class="brush:js">
#JS = loaddll( hidemarudir + @&quot;\hmJS.dll&quot; );

// WScript.Echo系を定義しておいて…
#_ = dllfuncw( #JS, &quot;DoString&quot;, R&quot;JS(
  WScript = {
    'Echo' : function(obj)
    {
      hm.Macro.Var('$__tmp_string', obj.toString()); // 伝達
      hm.Macro.Eval( function() { /*
        message($__tmp_string);
      */ } );
      hm.Macro.Var('$__tmp_string', &quot;&quot;); // 消滅
    }
  };
)JS&quot;
);


// 使う…
#_ = dllfuncw( #JS, &quot;DoString&quot;, R&quot;JS(
  WScript.Echo(&quot;あいう&quot;);
)JS&quot;
);

freedll( #JS );
</pre></div>



    <li>
    <h3>ActiveXObject</h3>
    <p>本来 JScriptのWSHやActiveXObjectなどの記述は、するべきではありません。<br>
    (WSH自体が10年前から廃止予定なため)<br>
    </p>
    <p>しかし、既存のコードを可能な限り流用したい、<br>
    といった要望は現実として存在します。<br>
    </p>
    <p>先のWScript.Echoの実装とあわせて、以下のように、従来の.jsによるActiveXObjectの記述と同じ記述がそのまま利用可能です。</p>
    <div class="code"><pre class="brush:python">

#JS = loaddll( hidemarudir + @&quot;\hmJS.dll&quot; );

#_ = dllfuncw( #JS, &quot;DoString&quot;, R&quot;JS(

//  ボタンの種類
var BTN_OK                 = 0;    // [ＯＫ]ボタン
var BTN_OK_CANCL           = 1;    // [ＯＫ][キャンセル]ボタン
var BTN_STOP_RETRI_DISRGRD = 2;    // [中止][再試行][無視]ボタン
var BTN_YES_NO_CANCL       = 3;    // [はい][いいえ][キャンセル]ボタン
var BTN_YES_NO             = 4;    // [はい][いいえ]ボタン
var BTN_RETRI_CANCL        = 5;    // [再試行][キャンセル]ボタン

//  アイコンの種類
var ICON_STOP              = 16;   // [Stop]アイコン
var ICON_QUESTN            = 32;   // [?]アイコン
var ICON_EXCLA             = 48;   // [!]アイコン
var ICON_I                 = 64;   // [i]アイコン

//  押されたボタンごとの戻り値
var BTNR_OK                =  1;   // [ＯＫ]ボタン押下時
var BTNR_CANCL             =  2;   // [キャンセル]ボタン押下時
var BTNR_STOP              =  3;   // [中止]ボタン押下時
var BTNR_RETRI             =  4;   // [再試行]ボタン押下時
var BTNR_DISRGRD           =  5;   // [無視]ボタン押下時
var BTNR_YES               =  6;   // [はい]ボタン押下時
var BTNR_NO                =  7;   // [いいえ]ボタン押下時
var BTNR_NOT               = -1;   // どのボタンも押さなかったとき


//  Windowsシェルへのアクセスを提供するオブジェクト
var sh = new ActiveXObject( &quot;WScript.Shell&quot; );

//  ポップアップウインドウを表示(10秒後に自動終了)
var rtn = sh.Popup( &quot;ボタンを押してください！&quot;, 10, &quot;確認&quot;, (BTN_YES_NO_CANCL + ICON_QUESTN) );

//  オブジェクトを解放
sh = null;

//  戻り値をデバッグ表示
hm.debuginfo(rtn);

)JS&quot;
);

freedll( #JS );

</pre></div>
</ul>