%(hilight)s
<h2><i class="fa fa-book fa-fw"></i>「hmJS」で既存の.NETのクラスを込みこむ</h2>

<ul class="checklist">
    <li>
    <h3>概要</h3>
    <p>ここでは、.NET Frameworkに最初から搭載されているものの、<br>
    手動で参照を追加する必要があるdll(例えばSystem.Windows.Formなど)を読み込む方法を記載しています。<br>
    </p>
    <li>
    <h3>スクリプト層</h3>
    <p>hmJSは、.NETのアセンブリの読み込みなどには対応しています。<br>
    しかし、根本的な部分で、JavaScriptにはガッチリとしたフルスペックの「クラス」の仕組み<br>
    は存在しません。<br>
    </p>
    <p>ですので、あくまでも、C#等で作成した.dll内で処理を済ませ、JavaScriptでは、それを呼ぶ、という方向性の方が、<br>
    見通しが良くなるハズです。<br>
    hmJSでは、「.dllへと値を渡す」こと・「.dllから値をもらうこと」に特化した方が上手くいきます。</p>
    <p>しかし、このページでは、<b><span class="negative">あえて「hmJS」の「スクリプト層」でゴリゴリと記述する例</span></b>として紹介しています。</p>
    <h3>フォームの実装</h3>
    <div class="code"><pre class="brush:python">
#JS = loaddll( hidemarudir + @&quot;\hmJS.dll&quot; );

#_ = dllfuncw( #JS, &quot;DoString&quot;, R&quot;(

var addlib = host.lib(&quot;System.Windows.Forms, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&quot;);

var TForms = addlib.System.Windows.Forms;
var TForm = TForms.Form;
var frm= new TForm();
frm.Text = &quot;こんにちわ&quot;;
var iClicked = 0;


var TButton = TForms.Button;
var btn = new TButton();
btn.Text = &quot;クリック&quot;;
btn.Left = 16;
btn.Top = 16;
btn.Click.connect(function (sender, args) {
    iClicked++;
    hm.debuginfo(&quot;ボタンが押されたよ!!&quot;);

    TForms.MessageBox.Show(iClicked.toString());

    hm.Macro.Var('$count', iClicked.toString());

    // 秀丸マクロとして一連の文字列を実行
    hm.Macro.Eval( function() { /*
        // アウトプット枠へ出力
        #OP = loaddll(&quot;HmOutputPane.dll&quot;);
        #ret = dllfunc(#OP, &quot;Output&quot;,hidemaruhandle(0), $count);
        freedll(#OP);
    */ } );
});

frm.Controls.Add(btn);
frm.ShowDialog();
)&quot;);

freedll(#JS);
</pre></div>
    <h3>実行イメージ</h3>
    <img src="./other_soft/hm_javascript/cnt_hm_javascript_03.png">
</ul>