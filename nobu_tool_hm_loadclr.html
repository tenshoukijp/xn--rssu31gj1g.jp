%(hilight)s
<h2><i class="fa fa-lua fa-fw"></i>hmLoadCLR (秀丸マクロ用 マネージdll loader)</h2>

<ul class="checklist">
    <li>
    <p>「C#」で作成した「マネージdll」を、<br>
    秀丸マクロで利用するためのdllとなります。</p>
    <p>もちろん「C#のdll」だけではなく、「C++/CLI・VB.net・F#・JScript.net」などで作成したdllでも大丈夫です。</p>
    <li>
    <h3>ダウンロード</h3>
    <dl>
        <dt>
        <div class="download_file"><img src="./other_soft/hm_loadclr/cnt_hm_loadclr_minizip.png" attr="noedge" align="middle"> ⇒ <a href="%(file)s">hmLoadCLR.zip</a>ファイル。ver 1.481</div>
        </dt>
        <dd>
        <div class="update_time">└更新日 %(year)04d/%(mon)02d/%(mday)02d</div>
        </dd>
    </dl>
    <li>
    <h3>動作環境</h3>
    <ul class="pointlist">
        <li>
        <h4>秀丸</h4>
        <p>秀丸エディタ ver8.66以上</p>
        <li>
        <h4>Microsoft VC++ 再頒布可能パッケージ</h4>
        <p><a href="https://www.microsoft.com/ja-jp/download/details.aspx?id=40784">Visual Studio 2013 C++ ランタイム</a><br>
        x86版をインストールしたことが無い方はインストールしてください。<br>
        <span class="negative">お手持ちのOSが64bitか32bitかには関わりなく、x86版のインストールが必要です。</span></p>
        <li>
        <h4>Microsoft .NET</h4>
        <p>.NET Framework 4.0以上。<br>
        </p>
        <li>
        <h4>秀丸エディタ 64bit版について</h4>
        <p>秀丸エディタ64bit版をご利用の方は、<a href="/other_soft/hm_loadclr/hmLoadCLR_x64.zip">hmLoadCLR_x64.zip</a>をダウンロードし、hmLoadCLR.dllを差し替えてください。<br>
        (又、この場合は、Microsoft VC++ 再頒布可能パッケージは、64bit版をインストールしてください。)
        </p>

    </ul>
    <li>
    <h3>インストール</h3>
    <ul>
        <li>hmLoadCLR.zipを解凍する。
        <li><span class="negative">「hmLoadCLR.dllを秀丸エディタのディレクトリ内(hidemaru.exeと同じ場所)へと コピー</span>する。<br>
        (<span class="negative">原則的には、hidemaru.exeと同じ場所である必要があります。これは.NET FrameWorkのdllを動作させる仕組みに拠るためです。)</span>
    </ul>
    <li>
    <h3>秀丸でマネージdllを使うメリット</h3>
    <ul class="pointlist">
        <li>
        <h4>CPU非依存性</h4>
        <p>32bitと64bitでプログラムを別々に作成する、などといったバカバカしいことから解放されます。<br>
        プログラムが少ないうちはいいですが、多くなったり、他のモジュールを数多く利用するようになると、<br>
        32bitと64bitでプログラムを分かれることは非常に足を引っ張ります。<br>
        そういったことから解放されます。</p>
        <li>
        <h4>メンテナンス性</h4>
        <p>ご存知の通り、ほとんどすべてのことにおいて、ネイティブと.NET Frameworkでは、<br>
        .NET Frameworkを利用したソースの方が簡単で、ソースがはるかに短く、難易度が低く、見通しが良いものとなります。<br>
        メンテナンス性が非常に高くなります。</p>
        <li>
        <h4>十分な実行速度</h4>
        <p>C#で作成された.dllはC++に比べると1/2～1/3ほどの速度しか出ませんが、<br>
        エディタ用途のdllとしては十分に高速だと言えるでしょう。</p>
        <li>
        <h4>高い資産性</h4>
        <p>マネージ.dllの開発速度やわかりやすさは、ネイティブC++では決して得られないものです。<br>
        dll間で「複雑な型」の変数をそのまま簡単に渡しあえる、参照しあえるのも、計り知れないメリットです。<br>
        </p>
    </ul>
    <li>
    <h3>hmLoadCLRとhmPyと比較・違い</h3>
    <p>hmLoadCLRでもhmPyでも、どちらでも「C#・C++/CLI・VB.net・F#・JScript.net」のマネージdllを読み込むことが出来ます。<br>
    では、両者はどのような役割の違いがあるのでしょうか。比較してみましょう。
    </p>
    <ul class="pointlist">
        <li>
        <h4>最初の読み込み時間</h4>
        <p>hmLoadCLRは比較的短い時間で最初の読み込みを終えることが出来ますが、<br>
        hmPyは最初の読み込みには少し時間がかかります。</p>
        <li>
        <h4>機能</h4>
        <p>hmPyはIronPythonをまるまる搭載していますので、 非常に豊富な機能を持っており、<br>
        クラス機構や.NETのクラスライブラリとの相性の良さなど、<br>
        .NET Frameworkとの親和性はスクリプト言語の中では他の追随を許しません。</p>
        <p>一方、hmLoadCLRは言語性能は、<br>
        Luaというシンプルな言語のみを搭載しています。<br>
        </p>
        <li>
        <h4>まとめ</h4>
        <p>このような性質から、hmLoadCLRでは、<br>
        <ul>
            <li>hmLoadCLR層では複雑なことはしない
            <li><b>hmLoadCLR層はあくまでも「秀丸マクロ」と「マネージdll」の間の値の橋渡しが中心、<br>
            処理のほとんどは「マネージdll」と「秀丸マクロ」でやる。</b>
        </ul>
        <p>といった使用シーンで使うのに向いています。</p>
        <p>一方、マネージdll内のクラスをスクリプト層で継承したり、長々とスクリプトを記述したり、<br>
        ある程度複雑な構造を「スクリプト層で直接」扱うのであれば、hmLoadCLRよりhmPyの方が向いています。</p>
    </ul>
    <li>
    <h3>ライセンス</h3>
    <ul class="pointlist">
        <li>
        <h4>hmLoadCLR</h4>
        <p>hmLoadCLRは、Apache License 2.0となります。<br>
        </p>
        <p>ソースは<a href="https://github.com/vscode-life/hidemaru-net/tree/master/win-hidemaru-app/hm_loadclr">github</a>にあります。</p>
        <li>
        <h4>Neo.Lua</h4>
        <p>hmLoadCLRはInternalアセンブリとしてNeo.Luaが利用されています。<br>
        詳細は、<a href="https://neolua.codeplex.com/">https://neolua.codeplex.com/</a>を見てください。</p>
    </ul>
</ul>