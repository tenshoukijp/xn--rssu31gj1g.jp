%(hilight)s
<h2><i class="fa fa-book fa-fw"></i>hmLoadCLRの応用のAPI</h2>


<ul class="checklist">
    <li>
    <h3>概要</h3>
    <p>hmLoadCLR自体が備えている残りのAPIは９つです。</p>
    <p>全ては「リスト」と「ディクショナリ」の値の取得・設定に関するものとなります。<br>
    </p>
    <p>似たような関数ですが、概念としてはたった１しかありません。</p>

    <div class="code"><pre class="brush:python">
変数名 [ キー名 ]
</pre></div>
    <p>このような<span class="positive">添え字でアクセスできるオブジェクト</span>の値を「取得」「設定」する関数です。</p>
    <p>これらは無理に覚える必要はありませんが、</p>

    <div class="code"><pre class="brush:python">
#_ = dllfunc( #MNG, &quot;DoString&quot;, &quot;aaa = {1,2,3,4,5,6}&quot; );  // 配列を定義
#_ = dllfunc( #MNG, &quot;SetNumVar&quot;, &quot;tmpnum&quot;, 100 ); // 一旦tmpnumというグローバル変数に値を設定
#_ = dllfunc( #MNG, &quot;DoString&quot;, &quot;aaa[3] = tmpstr&quot; ); // aaa[3]に値を設定
</pre></div>

    <p>と記述するところを</p>
    <div class="code"><pre class="brush:python">
#_ = dllfunc( #MNG, &quot;DoString&quot;, &quot;aaa = {1,2,3,4,5,6}&quot; );  // 配列を定義

// aaaの添え字[3]に100を代入
#_ = dllfunc( #MNG, &quot;SetNumItemOfList&quot;, &quot;aaa&quot;, 3, 100 );
</pre></div>

    <p>と記述できるということになります。<br>
    知っておくと記述が少し楽になるでしょう。</p>
    <p>以下のListやDict系の関数はhmPyと同じ名前の関数となります。</p>
    <li>
    <h3>リストにアクセスする４つの関数(***OfList)</h3>
    <p>厳密には「リスト」だけではなく、「タプル」や「独自に自分で定義したオブジェクト」も含め、<br>
    <span class="positive">「整数の添え字」でアクセス可能なモノ</span>」全てが含まれます。<br>
    </p>
    <ul class="pointlist">
        <li>
        <h4>「添え字は整数タイプ」・「アイテムは数値の値」を得る:<br>
        &nbsp;└ GetNumItemOfList(list_name, index)</h4>
        <p><span class="positive">aaa[3] の値を得るといった場合です。aaa[3]の中身が数値タイプだとわかっている場合に利用します。</span><br>
        <br>
        <br>
        </p>
        <li>
        <h4>「添え字は整数タイプ」・「アイテムは数値の値」を設定:<br>
        &nbsp;└ SetNumItemOfList(list_name, index, value)</h4>
        <p><span class="positive">aaa[3] = 10 のように値を設定したいといった場合です。</span><br>
        <br>
        <br>
        </p>
        <li>
        <h4>「添え字は整数タイプ」・「アイテムは文字列」として得る:<br>
        &nbsp;└ GetStrItemOfList(list_name, index)</h4>
        <p><span class="positive">aaa[3] の値を得るといった場合です。aaa[3]の中身を「文字列」に変換して取得する場合に利用します。</span><br>
        <br>
        <br>
        </p>
        <li>
        <h4>「添え字は整数タイプ」・「アイテムは文字列の値」を設定:<br>
        &nbsp;└ SetStrItemOfList(list_name, index, value)</h4>
        <p><span class="positive">aaa[3] = "aaa" のように文字列の値を設定したいといった場合です。</span><br>
        <br>
        <br>
        </p>
    </ul>

    <li>
    <h3>ディクショナリにアクセスする４つの関数(***OfDict)</h3>
    <p>厳密には「ディクショナリ」だけではなく、「独自に自分で定義したオブジェクト」も含め、<br>
    <span class="positive">「文字列の添え字」でアクセス可能なモノ</span>」全てが含まれます。<br>
    </p>
    <ul class="pointlist">
        <li>
        <h4>「添え字は文字列タイプ」・「アイテムは数値の値」を得る:<br>
        &nbsp;└ GetNumItemOfDict(list_name, key)</h4>
        <p><span class="positive">aaa["prop"] の値を得るといった場合です。aaa["prop"]の中身が数値タイプだとわかっている場合に利用します。</span><br>
        <br>
        <br>
        </p>
        <li>
        <h4>「添え字は文字列タイプ」・「アイテムは数値の値」を設定:<br>
        &nbsp;└ SetNumItemOfDict(list_name, key, value)</h4>
        <p><span class="positive">aaa["prop"] = 10 のように値を設定したいといった場合です。</span><br>
        <br>
        <br>
        </p>
        <li>
        <h4>「添え字は文字列タイプ」・「アイテムは文字列」として得る:<br>
        &nbsp;└ GetStrItemOfDict(list_name, key)</h4>
        <p><span class="positive">aaa["prop"] の値を得るといった場合です。aaa["prop"]の中身を「文字列」に変換して取得する場合に利用します。</span><br>
        <br>
        <br>
        </p>
        <li>
        <h4>「添え字は文字列タイプ」・「アイテムは文字列の値」を設定:<br>
        &nbsp;└ SetStrItemOfDict(list_name, key, value)</h4>
        <p><span class="positive">aaa["prop"] = "aaa" のように文字列の値を設定したいといった場合です。</span><br>
        <br>
        <br>
        </p>
    </ul>
    <li>
    <h3>DestroyScope関数</h3>
        <p>
            hmLoadCLR内に「DestroyScope」という名前の関数を用意しておくと、<br>
            マクロ終了時に自動的にその関数が実行されます。
        </p>
    <div class="code"><pre class="brush:lua">
function DestroyScope():
    hm.debuginfo(&quot;DestroyScope&quot;)
end
</pre></div>
</ul>