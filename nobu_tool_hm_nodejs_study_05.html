%(hilight)s
<h2><i class="fa fa-book fa-fw"></i>HmNodeJS・やってはいけないこと</h2>
<ul class="checklist">
    <li>
        <h3>概要</h3>
        <p>ここでは、HmNodeJSを利用するうえで、やってはいけないことを解説します。</p>
    <li>
        <h3>「jsを束縛して起動中のチャンネル」に、「異なるjsを束縛し直す」のはダメ</h3>
        <p>
            既に特定のチャンネルにjsを束縛してnode.jsサーバーが起動している状態では、<br>
            同じチャンネルに別のjsを束縛しなおしてはいけません。
        </p>
        <p>具体的な例をみていきましょう。</p>
        <ul class="pointlist">
            <li>
                <h4>１回目の実行</h4>
                <p><span class="keyword">50050に「HmNode<b>Sample</b>.js」を割り当て</span>て実行した。</p>
                <div class="code">
                    <pre class="brush:python;highlight:[9]">

#V8 = loaddll( hidemarudir + @&quot;\hmV8.dll&quot; );

#_ = dllfuncw( #V8, &quot;DoString&quot;, R&quot;ES6(

host.lib(clr, &quot;HmNodeClient&quot; );

var currentmacrodirectory = hm.Macro.Var[&quot;currentmacrodirectory&quot;];

var client = new clr.HmNodeClient(50050, currentmacrodirectory + &quot;/HmNodeSample.js&quot;);
client.Start();

var NameValueCollection = clr.System.Collections.Specialized.NameValueCollection;
var param = new NameValueCollection();
param.Add(&quot;word1&quot;, &quot;C:/abc/♬e.mac&quot;);
param.Add(&quot;myppp&quot;, &quot;そそそそそ&quot;);
var res = client.GetResponse(param);

console.log(res.Data);
console.log(res.CallCount);

hm.Macro.Var[&quot;$data&quot;] = res.Data + res.CallCount;

)ES6&quot;
);

message $data;

freedll( #V8 );

</pre>
                </div>
                <br>
                <br>
            <li>
                <h4>
                    以下のようなスクリプトへと書き換えて、２回目の実行
                </h4>
                <p>以下のスクリプトのように、<span class="keyword">同じ50050番に、別のスクリプト「HmNode<b>Example</b>.js」を割り当て</span>て実行。<br></p>
                <p>
                    <span class="negative">
                        <b>
                            これは許されません。<br>
                            すでに50050番にHmNodeSample.jsが紐づけされ、実行中なためです。
                        </b><br>
                    </span>
                </p>
                <p>
                    <span class="negative">一度50050番に、特定の.jsを束縛すると、全ての秀丸を終了するまでは、束縛は解けません。<br></span>
                    (.jsの変更は無視され、既に束縛済みだったJSが利用されます)<br>
                </p>
                <div class="code">
                    <pre class="brush:python;highlight:[9]">

#V8 = loaddll( hidemarudir + @&quot;\hmV8.dll&quot; );

#_ = dllfuncw( #V8, &quot;DoString&quot;, R&quot;ES6(

host.lib(clr, &quot;HmNodeClient&quot; );

var currentmacrodirectory = hm.Macro.Var[&quot;currentmacrodirectory&quot;];

var client = new clr.HmNodeClient(50050, currentmacrodirectory + &quot;/HmNodeExample.js&quot;);
client.Start();

var NameValueCollection = clr.System.Collections.Specialized.NameValueCollection;
var param = new NameValueCollection();
param.Add(&quot;word1&quot;, &quot;C:/abc/♬e.mac&quot;);
param.Add(&quot;myppp&quot;, &quot;おおおおおおお&quot;);
var res = client.GetResponse(param);

console.log(res.Data);
console.log(res.CallCount);

hm.Macro.Var[&quot;$data&quot;] = res.Data + res.CallCount;

)ES6&quot;
);

message $data;

freedll( #V8 );

</pre>
                </div>
        </ul>
</ul>