%(hilight)s
<h2><i class="fa fa-book fa-fw"></i>「hmPy・IronPython」HTMLのエンコード・デコード</h2>

<ul class="checklist">
    <li>
    <h3>概要</h3>
    <p>.NETにおいては、「http://」URLをプロセスとして実行すると、<br>
    Webに通常関連付けられているブラウザが起動しますが、<br>
    対象のWebページが「Webアプリ的なも」や「社内のhtmlページ的なもの」など定型・定型アプリであるとわかっているならば、<br>
    フル機能を持つWebブラウザではなく、Webコンポーネントを利用するのもアリでしょう。
    </p>
    <img src="./other_soft/hm_ironpython/cnt_hm_ironpython_miniweb.png" attr="noedge">
    <p>以下のものを「miniweb.mac」として保存してみましょう。</p>
    <div class="code"><pre class="brush:python">
#PY = loaddll( hidemarudir + @&quot;\hmPy.dll&quot; );
 
$url = &quot;http://www.google.com/&quot;;
 
#_ = dllfuncw(#PY, &quot;DoString&quot;, R&quot;IPY(

import clr

clr.AddReference(&quot;System.Windows.Forms&quot;)
clr.AddReference(&quot;System.Web&quot;)
clr.AddReference(&quot;System.Drawing&quot;)

import System
import System.IO
import System.Windows.Forms

from System.Windows.Forms import *
from System.Web import HttpUtility
from System.Drawing import *

from System import *

url = hm.Macro.Var[&quot;$url&quot;]

import clr
clr.AddReference('System.Windows.Forms')
from System.Windows.Forms import (
    Form,
    DockStyle,
    WebBrowser,
    TextBox,
    Keys
)

class MyWebForm(Form):

    def __init__(self):
        self.Text = 'ミニブラウザ'
        self.Width = 800
        self.Height = 600

        self.wb = WebBrowser()
        self.wb.Navigate(url)

        self.tb = TextBox()
        self.tb.Text = url


        # Layout
        self.tb.Dock = DockStyle.Top
        self.wb.Dock = DockStyle.Fill
        self.tb.KeyPress += self.OnKeyPress
        self.wb.Navigated += self.OnNavigated

        self.Controls.Add(self.wb)
        self.Controls.Add(self.tb)

    # Event handling
    def OnKeyPress(self, sender, event):
        if event.KeyChar == '\r':
            self.wb.Navigate(self.tb.Text.strip())

    def OnNavigated(self, sender, event):
        self.tb.Text = event.Url.ToString()

f = MyWebForm()
f.ShowDialog()

)IPY&quot;
);

freedll( #PY );
</pre></div>
</ul>