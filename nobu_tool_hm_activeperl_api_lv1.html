%(hilight)s
<h2><i class="fa fa-book fa-fw"></i>秀丸マクロからhmPerlへと命令する関数</h2>

<ul class="checklist">
    <li>
    <h3>概要</h3>
    <p>秀丸マクロからhmPerlに対して直接使用することが想定されている関数は、<br>
    「DoString」のたった１つだけです。</p>
    <li>
    <h3>Perlとして実行する</h3>
    <ul class="pointlist">
        <li>
        <h4>命令の実行:<br>
        &nbsp;└ DoString( ヒアドキュメント文字列 )</h4>
        <p><span class="positive">文字列「ヒアドキュメント文字列」をPerlの命令として実行します。</span><br>
        </p>
        <p>何らかの明確な内部エラーがあった場合は0が、とりあえず実行できた場合は1が返ってきます。 <br>
        <p>エラーなどがあった場合は、「<a href="?page=nobu_tool_hm_debugmonitor">秀丸・デバッグ出力モニター</a>」上に表示されます。</p>
    </ul>
    <h3>１つのマクロ内で「DoString」は複数回実行可能、変数空間も同じ</h3>
            <div class="code"><pre class="brush:perl">
#Perl = loaddll( hidemarudir + @&quot;\hmPerl.dll&quot; );

#_ = dllfuncw( #Perl, &quot;DoString&quot;, R&quot;PERL(

$aaa = &quot;あいうお&quot;;

sub mysum {
  return @_[0] + $_[1];
}

)PERL&quot;);


#bbb = 123;

#_ = dllfuncw( #Perl, &quot;DoString&quot;, R&quot;PERL(

$bbb = hm-&gt;Macro-&gt;Var('#bbb');
$ccc = $aaa . &quot;続いている&quot;; # 別のDoStringでも、$aaa は引き続き利用できる。

hm-&gt;Macro-&gt;Var('$ddd', $ccc );

hm-&gt;debuginfo( mysum(1,2) ); # 別のDoStringで定義した関数も当然利用できる。

)PERL&quot;);

message($ddd);

freedll( #Perl );
</pre></div>
</ul>