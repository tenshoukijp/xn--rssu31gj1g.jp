%(hilight)s
<h2><i class="fa fa-book fa-fw"></i>各言語でのHmNodeJS利用の最小サンプル</h2>

<ul class="checklist">
	<li>
	<h3>概要</h3>
	<p>ここでは、hmV8を含め、hmJS / hmPy / hmRb / hmLoadCLR での最小サンプルを紹介します。</p>

	<li>
	<h3>hmV8 (V8 ECMAScript6)</h3>
	<div class="code"><pre class="brush:python;">
#V8 = loaddll( hidemarudir + @&quot;\hmV8.dll&quot; );

#_ = dllfuncw( #V8, &quot;DoString&quot;, R&quot;ES6(

host.lib(clr, &quot;HmNodeClient&quot; );

var currentmacrodirectory = hm.Macro.Var[&quot;currentmacrodirectory&quot;];

/*
var options = new clr.HmNodeClient.Options();
options.ShowConsole = true;
var client = new clr.HmNodeClient(50001, currentmacrodirectory + &quot;/HmNodeSample.js&quot;, options);
*/

var client = new clr.HmNodeClient(50001, currentmacrodirectory + &quot;/HmNodeSample.js&quot;);

client.Start();

var NameValueCollection = clr.System.Collections.Specialized.NameValueCollection;
var param = new NameValueCollection();
param.Add(&quot;word1&quot;, &quot;C:/abc/♬e.mac&quot;);
param.Add(&quot;myppp&quot;, &quot;そそそそそ&quot;);
var res = client.GetResponse(param);

console.log(res.StatusDescription+&quot;いいい&quot;);
console.log(res.StatusCode+&quot;あああ&quot;);
console.log(res.Data);
console.log(res.CallCount);
console.log(res);

hm.Macro.Var[&quot;$data&quot;] = res.Data + res.CallCount;
)ES6&quot;
);

message $data;

freedll( #V8 );
</pre></div>

	<li>
	<h3>hmJS (JScript)</h3>
	<div class="code"><pre class="brush:python;">
#JS = loaddll( hidemarudir + @&quot;\hmJS.dll&quot; );

#_ = dllfuncw( #JS, &quot;DoString&quot;, R&quot;JS(
host.lib(clr, &quot;HmNodeClient&quot; );

var currentmacrodirectory = hm.Macro.Var(&quot;currentmacrodirectory&quot;);

/*
var options = new clr.HmNodeClient.Options();
options.ShowConsole = true;
var client = new clr.HmNodeClient(50001, currentmacrodirectory + &quot;/HmNodeSample.js&quot;, options);
*/

var client = new clr.HmNodeClient(50001, currentmacrodirectory + &quot;/HmNodeSample.js&quot;);

client.Start();

var NameValueCollection = clr.System.Collections.Specialized.NameValueCollection;
var param = new NameValueCollection();
param.Add(&quot;word1&quot;, &quot;C:/abc/♬e.mac&quot;);
param.Add(&quot;myppp&quot;, &quot;そそそそそ&quot;);
var res = client.GetResponse(param);

console.log(res.StatusDescription+&quot;いいい&quot;);
console.log(res.StatusCode+&quot;あああ&quot;);
console.log(res.Data);
console.log(res.CallCount);
console.log(res);

hm.Macro.Var(&quot;$data&quot;, res.Data + res.CallCount);
)JS&quot;
);

message $data;

freedll( #JS );
</pre></div>


	<li>
	<h3>hmPy (IronPython)</h3>
	<div class="code"><pre class="brush:python;">
#PY = loaddll( hidemarudir + @&quot;\hmPy.dll&quot; );
 
#_ = dllfuncw(#PY, &quot;DoString&quot;, R&quot;IPY(
import clr
clr.AddReferenceByPartialName(&quot;HmNodeClient&quot;) # dllの名前を拡張子など抜きで
 
import System
import HmNodeClient

currentmacrodirectory = hm.Macro.Var[&quot;currentmacrodirectory&quot;];

&quot;&quot;&quot;
options = HmNodeClient.Options()
options.ShowConsole = True
client = HmNodeClient(50001, currentmacrodirectory + &quot;/HmNodeSample.js&quot;, options)
&quot;&quot;&quot;

client = HmNodeClient(50001, currentmacrodirectory + &quot;/HmNodeSample.js&quot;)
client.Start()

param = System.Collections.Specialized.NameValueCollection()
param.Add(&quot;word1&quot;, &quot;C:/abc/♬e.mac&quot;)
param.Add(&quot;myppp&quot;, &quot;そそそそそ&quot;);
res = client.GetResponse(param)

hm.debuginfo(res.StatusDescription+&quot;いいい&quot;)
hm.debuginfo(res.StatusCode+&quot;あああ&quot;)
hm.debuginfo(res.Data)
hm.debuginfo(res.CallCount)
hm.debuginfo(res)

hm.Macro.Var[&quot;$data&quot;] = res.Data + str(res.CallCount)
)IPY&quot;
);

message $data;

freedll( #PY );

</pre></div>


	<li>
	<h3>hmRb (IronRuby)</h3>
	<div class="code"><pre class="brush:python;">
#RB = loaddll( hidemarudir + @&quot;\hmRb.dll&quot; );

#_ = dllfuncw( #RB, &quot;DoString&quot;, R&quot;IRB(
require 'mscorlib'
require &quot;System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&quot;

load_assembly 'HmNodeClient'

currentmacrodirectory = $hm.Macro.Var[&quot;currentmacrodirectory&quot;];

=begin
options = HmNodeClient::Options.new
options.ShowConsole = true
client = HmNodeClient.new(50001, currentmacrodirectory + &quot;/HmNodeSample.js&quot;, options)
=end

client = HmNodeClient.new(50001, currentmacrodirectory + &quot;/HmNodeSample.js&quot;)
client.Start()

param = System::Collections::Specialized::NameValueCollection.new
param.Add(&quot;word1&quot;, &quot;C:/abc/♬e.mac&quot;)
param.Add(&quot;myppp&quot;, &quot;そそそそそ&quot;);
$hm.debuginfo(client)

res = client.GetResponse(param)
$hm.debuginfo(res.StatusDescription+&quot;いいい&quot;)
$hm.debuginfo(res.StatusCode+&quot;あああ&quot;)
$hm.debuginfo(res.Data)
$hm.debuginfo(res.CallCount)
$hm.debuginfo(res)

$hm.Macro.Var[&quot;$data&quot;] = res.Data + res.CallCount.to_s
)IRB&quot;
);

message $data;

freedll( #RB );

</pre></div>

	<li>
	<h3>hmLoadCLR (NeoLua)</h3>
	<div class="code"><pre class="brush:python;">
#MNG = loaddll( hidemarudir + @&quot;\hmLoadCLR.dll&quot; );

#_ = dllfuncw( #MNG, &quot;DoString&quot;, R&quot;MNG(
local hidemarudir = hm.Macro.Var[&quot;hidemarudir&quot;]
load_assembly &quot;HmNodeClient&quot;

local currentmacrodirectory = hm.Macro.Var[&quot;currentmacrodirectory&quot;];

--[[
local options = clr.HmNodeClient.Options()
options.ShowConsole = true
local client = clr.HmNodeClient(50001, currentmacrodirectory .. &quot;/HmNodeSample.js&quot;, options)
]]

local client = clr.HmNodeClient(50001, currentmacrodirectory ..&quot;/HmNodeSample.js&quot;)

client.Start()

local NameValueCollection = clr.System.Collections.Specialized.NameValueCollection
local param = NameValueCollection()
param.Add(&quot;word1&quot;, &quot;C:/abc/♬e.mac&quot;)
param.Add(&quot;myppp&quot;, &quot;そそそそそ&quot;);
local res = client.GetResponse(param)

hm.debuginfo(res.StatusDescription..&quot;いいい&quot;)
hm.debuginfo(res.StatusCode..&quot;あああ&quot;)
hm.debuginfo(res.Data)
hm.debuginfo(res.CallCount)
hm.debuginfo(res)

hm.Macro.Var[&quot;$data&quot;] =  res.Data .. res.CallCount
)MNG&quot;
);

message $data;

freedll( #MNG );
</pre></div>



</ul>