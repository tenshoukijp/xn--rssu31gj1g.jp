%(hilight)s
<h2><i class="fa fa-book fa-fw"></i>「hmPy・IronPython」の例題③ Webデータの取得</h2>

<ul class="checklist">
    <li>
    <h3>概要</h3>
    <p>IronPythonの例題のひとつとなります。<br></p>

    <h3>Webデータの取得</h3>
    <p>C#で利用するのと、全く同一です。</p>

    <div class="code"><pre class="brush:python">
// 確保
#PY = loaddll( hidemarudir + @&quot;\hmPy.dll&quot; );
 
// 読み込むアドレスを変数に設定
$targeturl = &quot;http://www.yahoo.co.jp&quot;;
 
// WebClientを利用して、簡単に取得できる。
// 正規表現の利用なども。
#_ = dllfuncw(#PY, &quot;DoString&quot;, R&quot;IPY(
import clr
import System
clr.AddReferenceByPartialName('System.Net')
from System.Net import WebClient

# 秀丸マクロの$targeturlからコピー
targeturl = hm.Macro.Var[&quot;$targeturl&quot;]

content = WebClient().DownloadString(targeturl)

clr.AddReferenceByPartialName('System.Text.RegularExpressions')
from System.Text.RegularExpressions import Regex

# 「&lt;」の前に■を埋め込む
content = Regex.Replace(content, '&gt;(&lt;[a-zA-Z])', '&gt;■$1' )

# IronPythonのcontent_cr変数を、秀丸マクロの$content_crへとコピー
hm.Macro.Var[&quot;$content&quot;] = content

)IPY&quot;
);

debuginfo 1;
debuginfo $content;
 
// 解放
freedll(#PY);
</pre></div>
</ul>