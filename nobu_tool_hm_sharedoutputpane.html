%(hilight)s
<h2><i class="fa fa-list-alt fa-fw"></i>外部アプリケーションから秀丸のアウトプット枠への出力</h2>

<ul class="checklist">
    <li>
    <h3>概要</h3>
    <p>「<span class="positive">外部のアプリケーション</span>(=<span class="negative">秀丸から起動していないアプリケーション</span>)」から、 <br>
    <span class="negative">「今開いている秀丸」の「アウトプット枠」</span>へと<span class="negative">直接出力</span>するためのプラグインです。<br>
    </p>
    <p>もしも、アウトプット枠を閉じている場合でも、「外部アプリケーションからのメッセージ転送を検知すると」<br>
    <span class="negative">自動的にアウトプット枠を表示</span>します。</p>

    <ul>
    <li>一気に数十・数百といったメッセージ行をアウトプット枠に送信
    <li>ウィンドウアプリなどのボタンを押す度に秀丸へとメッセージ送信
    <li>複数のアプリから並列でごちゃまぜに秀丸へとメッセージ送信
    </ul>
    <p>いずれも問題なく処理されます。</p>
    <p><img src="./other_soft/hm_sharedoutputpane/cnt_hm_sharedoutputpane_01.png"></p>
    <li>
    <h3>ダウンロード</h3>
    <dl>
        <dt>
        <div class="download_file">DOWNLOAD ⇒ <a href="%(file)s">HmSharedOutputPane.zip</a>ファイル。ver 1.15</div>
        </dt>
        <dd>
        <div class="update_time">└更新日 %(year)04d/%(mon)02d/%(mday)02d</div>
        </dd>
    </dl>
    <h3>動作環境</h3>
    <ul>
        <li>秀丸エディタ <span class="negative">32ビット版 ver8.01以降</span>
        <fieldset class="alert"><legend><i class="fa fa-windows fa-fw"></i>Windowsのbit数ではなく、<i class="fa fa-hidemaru fa-fw"></i>秀丸のビット数</legend> Windows
        OSが64bit版か32bit版かは関係ありません。秀丸エディタが32bit版か64bit版かが問題です。<br>
        通常ですと、32bit版です。<br>
        <br>
        64bit版の人は<a href="./other_soft/hm_sharedoutputpane/HmSharedOutputPane_x64.zip">HmSharedOutputPane_x64.zip</a>を利用してください。<br>
        (この場合は、呼び出し元プログラムも64bitである必要があります)</fieldset>
    </ul>
    <h3>インストール</h3>
    <ul>
        <li>HmSharedOutputPane.zipを解凍する。
        <li>HmSharedOutputPane.dllを、秀丸本体(hidemaru.exe)と同じ場所にコピー。<br>
        (場所は変更してもＯＫです。その場合は、HmSharedOutputPane.macで読み込む場所を変更してください。)
        <li>HmSharedOutputPane.macを下記のように設定する。
    </ul>
    <li>
    <h3>HmSharedOutputPane.macの設定</h3>
    <ul>
        <li>秀丸のメニューより「マクロ」->「マクロ登録」
        <li>自動起動の設定を選び、「アクティブ切り替え」の項目として、「HmSharedOutputPane.mac」としてください。<br>
        (HmSharedOutputPane.macの配置場所は自由ですので、「参照」して読み込んでください)
        <li>もしもすでに「アクティブ切り替え」用のマクロがあるなら、「HmSharedOutputPane.mac」の中身は単純ですので、<br>
        適当にコピペして使ってください。</li>
        <p><img src="./other_soft/hm_sharedoutputpane/cnt_hm_sharedoutputpane_02.png"></p>
    </ul>

    <li>
    <h3>HmSharedOutputPane.macの内容解説</h3>
    <div class="code"><pre class="brush:hmmacro">
#dllsop = loaddll( hidemarudir + &quot;\\HmSharedOutputPane.dll&quot;); // HmSharedOutputPane.dllの読み込み。フォルダを変更する場合には指定変更のこと。

if(#dllsop) {
    #_ = dllfunc( #dllsop, &quot;SetHidemaruHandle&quot;, hidemaruhandle(0) ); // 現在の秀丸ウィンドウハンドルの伝達
    #_ = dllfunc( #dllsop, &quot;SetWithClearTime&quot;, -1 );                 // 新しいOutput枠を出す際に、前回のOutputから何ミリ秒経過するとクリアするか
} else {
    message(&quot;HmSharedOutputPane.dllが導入されていません。&quot;);
}

// ★ #dllsopをマクロ内で手動でfreedllしてはならない!! 秀丸が閉じられるとfreedllされます。
</pre></div>
    <li>
    <h3>SetWithClearTime(int iMilliSecond)</h3>
    <p><b>「SetWithClearTime」</b>が微妙に説明がわかりにくいですが、こういうことです。
    <ul>
        <li>Output枠に文字列を表示し続けていると、そのうち、<span span="negative">文字列が何千行にもなってしまいます</span>。<br>
        <li>よって、「何かを契機として１回全部クリア」した方が便利な場合が多い。<br>
        <li>そこで、HmSharedOutputPaneでは、「最後のOutput枠への出力からの経過時間」をクリアの契機としています。
        <li>例えば、SetWithClearTime(10000); などとすると、<br>
        「最後のOutput枠への出力から、10000ミリ秒(=10秒)以上の経過時間があった際は、<br>
        次回Output枠への出力の際は、Output枠を一旦クリアしてから文字列を出力する」となります。<br>
        又、SetWithClearTime(-1); とすると、「クリアはしない」という意味となります。<br>
        デフォルトでは「クリアはしない」設定、つまり、SetWithClearTime(-1) と同じことになっています。
    </ul>
    <li>
    <h3>注意点</h3>
    <ul class="pointlist">
        <li>
        <h4>一行あたりの文字数の制限</h4>
        <p>一行は1024バイトまでです。<br>厳密には文字列として使用可能なのは1023バイトです。</p>
        <li>
        <h4>行の制限</h4>
        <p>行のバッファは5000行です。<br>
        このバッファーとは、<span class="negative">文字列を受信しているが、まだアウトプット枠に表示していない行数</span>となります。<br>
        よって、あまりにも送信速度が速すぎる場合には、破たんしてしまうこととなります。(過去のバッファーは無かったことになる)</p>
        <p>ものすごい大量の文字列と行数を、秀丸へと継続的に「送信し続ける場合」には、<br>
        秀丸のアウトプットへの掃きが付いていけるように、送信側で「Sleep」を入れなど、送信速度をコントロールしてください。</p>
    </ul>
    <li>
    <h3>備考</h3>
    <p>普通のマクロでは決して実現不可能な独自の仕組みを採用しているため、<br>
    アウトプット枠へのデータ受信中であっても</p>
    <ul>
        <li>秀丸で「ファイルの編集」
        <li>「マクロの実行」
        <li>平行してマクロや検索側から「アウトプット枠への出力」
    </ul>
    <p>など普段の操作の全ては受付可能です。<br>
    <ul>
        <li>外部アプリの起動が先で、秀丸の起動が後でも問題ありません。<br>
        秀丸が出遅れた分のデータ文字列は蓄積され(500行に収まる分に限ります)、秀丸起動後からデータの受信を開始します。<br>
        <li>一旦秀丸を閉じたり再起動したりしても問題ありません。<br>
        閉じていた間のデータ文字列は蓄積され(500行に収まる分に限ります)、起動後の分からバッファーの分も含めてデータ受信を再開します。<br>
    </ul>

    <li>
    <h3>ライセンス等</h3>

    <ul class="pointlist">
        <li>
        <h4>HmSharedOutputPane.mac</h4>
        <p>HmSharedOutputPane.macは自由に利用してください。特にライセンスはありません。<br>
        <li>
        <h4>HmSharedOutputPane.dll</h4>
        <p>HmSharedOutputPane.dll、及び、そのソースはMITライセンスです。<br>
        ソースは<a href="https://github.com/vscode-life/hidemaru-net/tree/master/win-hidemaru-app/hm_sharedoutputpane">Github</a>に上がっています。</p>
    </ul>
</ul>