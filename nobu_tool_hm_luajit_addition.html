%(hilight)s
<h2><i class="fa fa fa-book fa-fw"></i>hmLJで特別に追加されているlua関数等</h2>
<ul class="checklist">
    <li>
    <h3>概要</h3>
    <p>hmLJはLuaJIT v2.0.4の機能の全てを踏襲しています。<br>
    しかし、素のLuaJITの状態では</p>
    <ul>
        <li>(cp932/sjisが主流の)秀丸マクロ上での使い心地
        <li>(LuaJITではない)普通のLuaのソースとの互換性
    </ul>
    <p>といった点で大きな問題が発生します。<br>
    </p>
    <p>そこでhmLJでは、特別に以下のような「修正」や「API追加」が施されています。</p>


    <li>
    <h3>機能の概要</h3>
    <ul class="pointlist">
        <li>
        <h4>cp932(sjis)の文字コードに強い</h4>
        <p>レガシー文字列であるcp932(sjis)を中心とする秀丸マクロ内外での使い勝手を向上するため、<br>
        cp932(sjis)の文字コードで記述されたLuaコードが原則そのまま取り扱えるようになっています。<br>
        cp932の文字を対象とするための専用の関数なども基本的なものなら取り揃えています。</p>
        <li>
        <h4>5.2への対応</h4>
        <p>独自拡張を施しており、その中には、Lua 5.2向きに書かれたスクリプトを互換動作させるような修正も含まれます。 <br>
        Lua5.2の深層機能を利用していない限り、Lua5.2のスクリプトも極めて高い確率で動作します。 <br>
        </p>
        <li>
        <h4>5.3への対応</h4>
        <p>Lua5.3にて導入されたビット演算子こそありませんが、Lua5.3で追加されたLua関数の多くが、hmLJにも実装されています。<br>
        よって、Lua5.3向けに記述されたスクリプトすらも、それなりに高い確率で動作します。 <br>
        </p>
    </ul>

    <li>
    <h3>特別な追加機能</h3>
    <ul class="pointlist">
        <li>
        <h4>秀丸デバッグモニターへの出力機能</h4>
        <ul class="arrowlist">
            <li>
            <h5>hm.debuginfo(...) 関数</h5>
            <p>luaのprint関数と同じですが、出力先が「秀丸デバッグモニター」など「DebugMonitor」系ツールとなります。<br>
            (これは、hmPyやhmRbと共通仕様となります)</p>
        </ul>
        <li>
        <h4>追加ライブラリ</h4>
        <ul class="arrowlist">
            <li>
            <h5>lfs(LuaFileSystem)</h5>
            <p>Lua言語では準標準ライブラリともいっても差し支えない「<a href="https://luapower.com/lfs">lfs</a>」ライブラリを追加しています。<br>
            </p>
            <li>
            <h5>bit32</h5>
            <p>luajitに元々備わっているbitライブラリとは別に、<br>
            Lua5.2の資産でも流用しやすいように、5.2と同一動作のbit32ライブラリも追加されています。 <br>
            </p>
            <li>
            <h5>cp932(sjis)用の関数</h5>
            <p>stringライブラリやutf8ライブラリのcp932版として、<br>
            (<b>cp932.len、cp932.upper、cp932.lower、cp932.reverse、cp932.sub、cp932.char、cp932.codepoint、cp932.codes、<br>
            そして、sjisをutf8へと変換するための cp932.encode(文字列, "utf8")</b>) が追加されています。<br>
            </p>
            <li>
            <h5>math系関数</h5>
            <p>luaの5.3にて新たに加えられたmath関数を持っています。<br>
            (<b>math.type、 math.ult、math.mininteger、math.maxinteger、math.tointeger、math.round(x [, precision ]))</b>)<br>
            </p>
            <li>
            <h5>string系関数</h5>
            <p>luaの5.3にて新たに加えられたstring関数を持っています。<br>
            (<b>string.pack、string.unpack</b>)<br>
            </p>
            <li>
            <h5>文字列エンコードを推測する関数</h5>
            <p>string.getencoding(文字列)<br>
            が追加されています。<br>
            主に対象の文字コードが「utf8」か「cp932」かを判定するための関数となります。<br>
            (その他も判定可能ですが、誤判定が多くなるでしょう)</p>
            <li>
            <h5>table系関数</h5>
            <p>nilもしくは空のテーブルであることを判定するtable.emptyが追加されています。</p>
            <p>luaの5.2の機能に準ずる ２つの関数を搭載しています。<br>
            (<b>table.unpack / table.pack</b>)
            <p>luaの5.3にて新たに加えられたtable関数を持っています。<br>
            (<b>table.move</b>)</p>
            <li>
            <h5>utf8系関数</h5>
            <p>luaの5.3にて加えられたutf8系ライブラリを全て持っています。<br>
            (そして、utf8をcp932に変換するための <b>utf8.encode(文字列, "cp932")</b> )が特別に追加されています。 <br>
            </p>
            <li>
            <h5>json系関数</h5>
            <p><a href="http://www.kyne.com.au/~mark/software/lua-cjson-manual.html#_api_functions">cjson</a>ライブラリが特別に追加されています。<br>
            外部に保存するための永続データ用APIがデフォルトで１つ搭載されていると使い勝手が良いと判断したためです。</p>
        </ul>
    </ul>
</ul>